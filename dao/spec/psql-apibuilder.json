{
  "name": "psql-apibuilder",
  "attributes": [
    {
      "name": "scala",
      "value": {
        "version": "3.4",
        "package": "db.generated",
        "dao_user_class": "java.util.UUID"
      }
    },
    {
      "name": "psql",
      "value": {
        "pkey": "id",
        "hash_code": {},
        "audit": {
          "created_at": { "type": "date-time-iso8601" },
          "updated_at": { "type": "date-time-iso8601" },
          "updated_by_user_id": { "type": "string" }
        }
      }
    }
  ],

  "models": {
    "generator_invocation": {
      "fields": [
        {
          "name": "id",
          "type": "string"
        },
        {
          "name": "key",
          "type": "string"
        },
        {
          "name": "organization_key",
          "type": "string",
          "required": false
        },
        {
          "name": "application_key",
          "type": "string",
          "required": false
        }
      ],
      "attributes": [
        {
          "name": "scala",
          "value": {
            "id_generator": {
              "class": "com.mbryzek.util.IdGenerator",
              "prefix": "gni"
            }
          }
        }
      ]
    },

    "task": {
      "fields": [
        { "name": "id", "type": "string" },
        { "name": "type", "type": "string" },
        { "name": "type_id", "type": "string" },
        { "name": "organization_guid", "type": "uuid", "required": false },
        { "name": "num_attempts", "type": "integer", "minimum": 0, "default": 0 },
        { "name": "next_attempt_at", "type": "date-time-iso8601" },
        { "name": "errors", "type": "[string]", "required": false },
        { "name": "stacktrace", "type": "string", "required": false },
        { "name": "data", "type": "json" }
      ],
      "attributes": [
        {
          "name": "scala",
          "value": {
            "order_by": { "optional": true }
          }
        },
        {
          "name": "psql",
          "value": {
            "on_conflict": {
              "fields": ["type_id", "type"]
            },
            "indexes": [
              { "fields": ["num_attempts", "next_attempt_at"] }
            ]
          }
        }
      ]
    }
  }
}
